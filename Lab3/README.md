# Структура программы

Проект содержит следующие:
> Папка Options, содержит:
  - класс Options
  - класс ArchiveOptions
> Папка Parser, содержит:
  - класс ConfigurationManager
  - интерфейс IParser
  - класс ParserJson
  - класс ParserXML
> Папка Files, содержит:
  - файл JsonFile.json
  - файл XMLFile.xml
  - файл XMLFile.xsd

Также проект содержит файлы классы:
- Program
- Logger
- Service1
- Service1.Designer
- Installer1
- Installer1.Designer
- SymmetricEncryption

# Описание программы

3 лабораторная работа представляет собой усовершенственную Windows-службу, созданную во 2 лабораторной работе. Во второй лабораторной работе мы разработали сервис для мониторинга директорий и манипуляции с файлами (архивирование, шифрование, передача). Но все конфигурируемые свойства, например, были захардкожены. В третьей же лабораторной работе мы реализовали переносимую/изменяемую систему конфигурации сервиса в формате XML и Json. 

Важным отличием является то, что все исключительные ситуации обрабатываются и логируются в файл Exception.txt. При этом, если данного файла е существует, то он создается, а если файл был создан ранее, то новые данные просто дописываются в конец файла.

Для того, чтобы отобразить каждый логический блок конфигураций был разработан класс Options. Он содержит объект настроек, по которым работает служба. Настройки архивации были объединены в один блок и описываются классом ArchiveOptions.

XMLFile.xml - файл, представляющий собой экземпляр класса Options, написанный в формате XML.

JsonFile.json - файл, представляющий собой экземпляр класса Options, написанный в формате Json.

XMLFile.xsd – файл, который содержит описание нашей схемы и с помощью которого происходит валидация файла XMLFile.xml.

Классы ParserXML и ParserJson – содержат описание парсеров xml и json. Основным преимуществом является то, что эти парсеры не используют встроенные парсеры C# а также являются универсальными, т.е. изменение файлов настроек (добавление нового тэга/секции в xml или объекта/поля в json) не повлечет за собой изменения парсера. Каждый парсер наследуется от интерфейса IParser, который в свою очередь описывается одним полем (T GetOptions()).

Класс ConfigurationManager – менеджер конфигураций, который при наличии определённого типа конфигурационного файла (XML/JSON) будет принимать решение о том, какой конфигурационный файл использовать. Менеджер конфигурации получает на вход путь к файлу (с использованием AppDomain). Если же подходящий файл не найден, выбрасывается исключение.

Service1.cs – файл службы. В классе Service1 описаны события OnStart(), OnStop(). В событии OnStart(), происходит процесс валидации xml файла с помощью xsd файла.

Installer1.cs – файл установки службы.
